<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Arvind Super Market — Modern E‑Commerce</title>
  <meta name="description" content="Fully responsive e‑commerce website in a single HTML file with modern UI/UX, search, filters, sorting, cart, wishlist, order summary, and checkout." />
  <style>
    :root{
      --bg:#0b1220;         /* background */
      --panel:#0f172a;      /* cards/panels */
      --muted:#94a3b856;    /* borders */
      --text:#e2e8f0;       /* primary text */
      --sub:#94a3b8;        /* secondary text */
      --brand:#6ee7b7;      /* brand accent */
      --brand-2:#60a5fa;    /* secondary accent */
      --danger:#ef4444;
      --warn:#f59e0b;
      --ok:#22c55e;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial,Apple Color Emoji,Segoe UI Emoji;
      color:var(--text); background: radial-gradient(1200px 800px at 20% -10%, #1f2937 0%, transparent 60%) , var(--bg);
      overflow-x:hidden;
    }
    a{color:inherit; text-decoration:none}
    img{max-width:100%; display:block}
    /* Layout */
    .container{max-width:1200px; margin:0 auto; padding: 0 16px}
    header{
      position:sticky; top:0; z-index:50; backdrop-filter:saturate(180%) blur(12px);
      background: linear-gradient(180deg, rgba(15,23,42,.9), rgba(15,23,42,.75));
      border-bottom:1px solid var(--muted);
    }
    .nav{display:flex; align-items:center; justify-content:space-between; gap:14px; padding:14px 0}
    .brand{display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.3px}
    .brand .logo{width:38px; height:38px; display:grid; place-items:center; border-radius:12px;
      background: conic-gradient(from 200deg, var(--brand-2), var(--brand));
      box-shadow: inset 0 0 12px rgba(255,255,255,.2), var(--shadow);
    }
    .brand span{font-size:18px}

    .nav-actions{display:flex; align-items:center; gap:10px}
    .btn{display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:12px; border:1px solid var(--muted); background:#0b1220;
      box-shadow: 0 6px 16px rgba(0,0,0,.25); transition: transform .15s ease, border-color .2s ease, background .2s ease, box-shadow .2s ease;
      cursor:pointer; color:var(--text); font-weight:600; font-size:14px
    }
    .btn:hover{transform: translateY(-1px); border-color:#7dd3fc}
    .btn.primary{background: linear-gradient(180deg, #1e293b, #0b1220); border-color:#3b82f680}
    .btn.ghost{background: transparent}
    .icon{width:18px; height:18px}
    .pill{font-size:12px; border:1px solid var(--muted); padding:6px 10px; border-radius:999px}

    /* Search */
    .searchbar{flex:1; display:flex; align-items:center; gap:10px; padding:8px 12px; border-radius:999px; border:1px solid var(--muted); background: #0b1220}
    .searchbar input{flex:1; background:transparent; border:none; outline:none; color:var(--text); font-size:14px}

    /* Tabs/Router */
    main{padding: 24px 0 80px}
    section.page{display:none; animation: fadeIn .3s ease}
    section.page.active{display:block}
    @keyframes fadeIn{from{opacity:0; transform: translateY(6px)} to{opacity:1; transform:none}}

    /* Hero */
    .hero{display:grid; gap:24px; grid-template-columns: 1.1fr .9fr; align-items:center; padding: 24px; border:1px solid var(--muted); border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(96,165,250,.08), rgba(110,231,183,.05)); box-shadow: var(--shadow);
    }
    .hero h1{margin:0 0 12px; font-size: clamp(28px, 3vw, 44px)}
    .hero p{margin:0 0 16px; color:var(--sub)}
    .hero-cta{display:flex; gap:10px; flex-wrap:wrap}

    /* Grid */
    .grid{display:grid; gap:16px}
    .grid.products{grid-template-columns: repeat(4, minmax(0,1fr))}
    @media (max-width: 1100px){.grid.products{grid-template-columns: repeat(3, minmax(0,1fr))}}
    @media (max-width: 800px){
      .nav{flex-wrap:wrap}
      .searchbar{order:3; width:100%}
      .hero{grid-template-columns: 1fr}
      .grid.products{grid-template-columns: repeat(2, minmax(0,1fr))}
    }
    @media (max-width: 520px){.grid.products{grid-template-columns: 1fr}}

    /* Card */
    .card{background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01)); border:1px solid var(--muted); border-radius:16px; overflow:hidden; box-shadow: var(--shadow); position:relative}
    .card .thumb{height:180px; background:#111827; display:grid; place-items:center; overflow:hidden}
    .card .thumb img{width:105%; height:105%; object-fit:cover; filter:saturate(1.1)}
    .card .body{padding:12px}
    .price{font-weight:800}
    .strike{color:#94a3b8aa; text-decoration: line-through; margin-left:8px}
    .badge{position:absolute; top:10px; left:10px; background:rgba(96,165,250,.9); color:#03121f; font-weight:900; font-size:12px; padding:6px 8px; border-radius:999px}
    .wish{position:absolute; top:8px; right:8px; width:36px; height:36px; display:grid; place-items:center; border-radius:999px; background:rgba(0,0,0,.35); border:1px solid var(--muted); cursor:pointer}
    .wish.active{background: rgba(110,231,183,.18); border-color:#6ee7b7}

    /* Sidebar filters */
    .shop{display:grid; grid-template-columns: 280px 1fr; gap:18px}
    @media (max-width: 900px){.shop{grid-template-columns: 1fr}}
    .side{position:sticky; top:84px; align-self:start; padding:14px; border:1px solid var(--muted); border-radius:16px; background:rgba(2,6,23,.6); box-shadow:var(--shadow)}
    .side h4{margin:6px 0 10px}
    .side .group{padding:10px 0; border-top:1px dashed var(--muted)}
    .side label{display:flex; align-items:center; gap:8px; margin:6px 0; color:var(--sub)}
    .range{display:flex; align-items:center; gap:8px}
    input[type="range"]{width:100%}

    /* Table */
    table{width:100%; border-collapse: collapse}
    th,td{padding:12px; border-bottom:1px solid var(--muted)}
    th{color:var(--sub); font-weight:600; text-align:left}

    .total{display:flex; justify-content:space-between; padding:10px 0; border-top:1px dashed var(--muted)}
    .kbd{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; border:1px solid var(--muted); padding:2px 6px; border-radius:6px; font-size:12px}

    /* Forms */
    form{display:grid; gap:12px}
    .field{display:grid; gap:6px}
    .field input, .field select, .field textarea{padding:12px; border-radius:12px; border:1px solid var(--muted); background:#0b1220; color:var(--text)}
    .two{display:grid; grid-template-columns: 1fr 1fr; gap:12px}
    @media (max-width:700px){.two{grid-template-columns:1fr}}

    /* Footer */
    footer{border-top:1px solid var(--muted); padding:26px 0; color:var(--sub)}

    /* Toast */
    .toast{position:fixed; bottom:20px; right:20px; background:#0b1220; border:1px solid var(--muted); padding:10px 14px; border-radius:10px; box-shadow:var(--shadow); opacity:0; transform: translateY(8px); pointer-events:none}
    .toast.show{opacity:1; transform:none; transition: all .2s ease}

    /* Smooth tiny hover */
    .hoverable{transition: transform .18s ease}
    .hoverable:hover{transform: translateY(-2px)}

    /* Hide utility */
    .hide{display:none!important}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <a class="brand" href="#home" aria-label="Go to Home" onclick="route(event)">
        <div class="logo" aria-hidden="true">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 12h14" stroke="#03121f" stroke-width="2"/>
            <circle cx="12" cy="12" r="8" stroke="#03121f" stroke-width="2"/>
          </svg>
        </div>
        <span>Arvind Super Market</span>
      </a>

      <div class="searchbar" role="search">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="11" cy="11" r="7"/><path d="M21 21l-4.35-4.35"/></svg>
        <input id="search" type="search" placeholder="Search products (Press /)" aria-label="Search products" />
        <span class="pill hide" id="searchCount">0 results</span>
      </div>

      <div class="nav-actions">
        <button class="btn ghost" onclick="go('#shop')" title="Shop">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 7h18l-1.5 12h-15z"/><path d="M8 7a4 4 0 0 1 8 0"/></svg>
          Shop
        </button>
        <button class="btn ghost" onclick="go('#wishlist')" title="Wishlist">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M20.8 8.6a5.5 5.5 0 0 0-9.8-3.6 5.5 5.5 0 0 0-9.8 3.6c0 7.2 9.8 11.8 9.8 11.8s9.8-4.6 9.8-11.8z"/></svg>
          <span id="wishCount" class="pill">0</span>
        </button>
        <button class="btn primary" onclick="go('#cart')" title="Cart">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="10" cy="20" r="1"/><circle cx="18" cy="20" r="1"/><path d="M2 3h3l3.6 12.59a2 2 0 0 0 2 1.41h7.9a2 2 0 0 0 2-1.6L23 7H6"/></svg>
          <span id="cartCount" class="pill">0</span>
        </button>
        <button class="btn" onclick="go('#auth')" title="Login or Register">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="7" r="4"/><path d="M5.5 21a7 7 0 0 1 13 0"/></svg>
          Login
        </button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- HOME -->
    <section id="home" class="page active">
      <div class="hero">
        <div>
          <h1>Quality products. Clean design. Smooth shopping.</h1>
          <p>Discover electronics, fashion, home & kitchen, and more — curated for value. Fast checkout, wishlist, and secure payment integration included.</p>
          <div class="hero-cta">
            <button class="btn primary hoverable" onclick="go('#shop')">Start Shopping</button>
            <button class="btn hoverable" onclick="go('#about')">About Us</button>
          </div>
        </div>
        <div aria-hidden="true">
          <div class="card" style="transform: rotate(-2deg)">
            <div class="thumb">
              <img alt="Hero" src="https://picsum.photos/seed/market/800/400"/>
            </div>
          </div>
        </div>
      </div>

      <h2 style="margin:26px 0 10px">Trending Now</h2>
      <div id="trending" class="grid products"></div>
    </section>

    <!-- SHOP -->
    <section id="shop" class="page">
      <div class="shop">
        <aside class="side">
          <div class="group">
            <h4>Categories</h4>
            <div id="catFilters"></div>
          </div>
          <div class="group">
            <h4>Brands</h4>
            <div id="brandFilters"></div>
          </div>
          <div class="group">
            <h4>Price</h4>
            <div class="range"><input id="priceRange" type="range" min="0" max="2000" value="2000" oninput="updatePriceRange(this.value)"><span id="priceValue" class="kbd">₹2000</span></div>
          </div>
          <div class="group">
            <h4>Rating</h4>
            <select id="ratingFilter" onchange="renderProducts()">
              <option value="0">Any rating</option>
              <option value="4">4★ & up</option>
              <option value="3">3★ & up</option>
              <option value="2">2★ & up</option>
            </select>
          </div>
          <div class="group">
            <h4>Show</h4>
            <label><input type="checkbox" id="onlyDeals" onchange="renderProducts()"> On sale</label>
            <label><input type="checkbox" id="onlyWishlist" onchange="renderProducts()"> Wishlist only</label>
          </div>
        </aside>

        <div>
          <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:12px">
            <h2 style="margin:0">Shop</h2>
            <div>
              <label class="pill">Sort by
                <select id="sort" onchange="renderProducts()" style="margin-left:8px; background:transparent; border:none; color:var(--text)">
                  <option value="pop">Popularity</option>
                  <option value="price-asc">Price: Low to High</option>
                  <option value="price-desc">Price: High to Low</option>
                  <option value="name">Name</option>
                  <option value="rating">Rating</option>
                </select>
              </label>
            </div>
          </div>
          <div id="productGrid" class="grid products"></div>
        </div>
      </div>
    </section>

    <!-- PRODUCT DETAILS -->
    <section id="product" class="page">
      <div id="productDetail"></div>
    </section>

    <!-- WISHLIST (simple view inside Shop filter, this page lists them all) -->
    <section id="wishlist" class="page">
      <h2>My Wishlist</h2>
      <div id="wishlistGrid" class="grid products"></div>
    </section>

    <!-- CART -->
    <section id="cart" class="page">
      <h2>Cart</h2>
      <div id="cartView"></div>
    </section>

    <!-- CHECKOUT -->
    <section id="checkout" class="page">
      <h2>Checkout</h2>
      <div class="two">
        <div class="card" style="padding:16px">
          <h3 style="margin-top:0">Shipping Details</h3>
          <form id="checkoutForm" onsubmit="submitOrder(event)">
            <div class="two">
              <div class="field"><label>Full Name<input required name="name" placeholder="Your name"></label></div>
              <div class="field"><label>Phone<input required name="phone" placeholder="10-digit"></label></div>
            </div>
            <div class="field"><label>Email<input type="email" required name="email" placeholder="you@example.com"></label></div>
            <div class="field"><label>Address<textarea required name="address" rows="3" placeholder="Street, City, State, PIN"></textarea></label></div>
            <div class="two">
              <div class="field"><label>City<input required name="city"></label></div>
              <div class="field"><label>PIN Code<input required name="pin" pattern="\d{6}" placeholder="6-digit"></label></div>
            </div>
            <div class="field"><label>Payment Method
              <select name="payment" required>
                <option value="cod">Cash on Delivery</option>
                <option value="card">Card (Test)</option>
                <option value="upi">UPI (Test)</option>
              </select>
            </label></div>
            <div style="display:flex; gap:10px; flex-wrap:wrap">
              <button class="btn primary" type="submit">Place Order</button>
              <button class="btn" type="button" onclick="go('#cart')">Back to Cart</button>
            </div>
          </form>
        </div>
        <div class="card" style="padding:16px">
          <h3 style="margin-top:0">Order Summary</h3>
          <div id="orderSummary"></div>
          <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap">
            <button class="btn" onclick="simulatePayment('razorpay')">Pay with Razorpay (Test)</button>
            <button class="btn" onclick="simulatePayment('stripe')">Pay with Stripe (Test)</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about" class="page">
      <div class="card" style="padding:18px">
        <h2 style="margin-top:0">About Arvind Super Market</h2>
        <p>We are a demo storefront built in a single HTML file. The UI is handcrafted with CSS and vanilla JS: no frameworks, yet fast and smooth. Use this as a starter and hook it to your backend or headless CMS.</p>
        <ul>
          <li>Mobile‑first responsive design</li>
          <li>Search, filters, sorting</li>
          <li>Wishlist and cart with localStorage persistence</li>
          <li>Order summary and checkout form</li>
          <li>Mock payment buttons you can replace with real gateway keys</li>
        </ul>
      </div>
    </section>

    <!-- CONTACT -->
    <section id="contact" class="page">
      <div class="card" style="padding:18px">
        <h2 style="margin-top:0">Contact Us</h2>
        <form onsubmit="contactSubmit(event)">
          <div class="two">
            <div class="field"><label>Your Name<input required name="cname"></label></div>
            <div class="field"><label>Email<input required type="email" name="cemail"></label></div>
          </div>
          <div class="field"><label>Message<textarea required name="cmsg" rows="4"></textarea></label></div>
          <button class="btn primary">Send Message</button>
        </form>
      </div>
    </section>

    <!-- AUTH -->
    <section id="auth" class="page">
      <div class="two">
        <div class="card" style="padding:18px">
          <h3 style="margin-top:0">Login</h3>
          <form onsubmit="loginSubmit(event)">
            <div class="field"><label>Email<input required type="email" name="lemail"></label></div>
            <div class="field"><label>Password<input required type="password" name="lpass"></label></div>
            <button class="btn primary">Login</button>
          </form>
        </div>
        <div class="card" style="padding:18px">
          <h3 style="margin-top:0">Register</h3>
          <form onsubmit="registerSubmit(event)">
            <div class="two">
              <div class="field"><label>First Name<input required name="fname"></label></div>
              <div class="field"><label>Last Name<input required name="lname"></label></div>
            </div>
            <div class="field"><label>Email<input required type="email" name="email"></label></div>
            <div class="field"><label>Password<input required type="password" name="pass" minlength="6"></label></div>
            <button class="btn primary">Create Account</button>
          </form>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container" style="display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap">
      <p>© <span id="year"></span> Arvind Super Market. All rights reserved.</p>
      <p>Made with ♥ — Demo project. Replace mock payment with your live keys.</p>
    </div>
  </footer>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    // ====== Demo product data ======
    const PRODUCTS = [
      {id:1, title:'Wireless Headphones X1', brand:'Sonic', category:'Electronics', price:1999, mrp:2499, rating:4.4, stock:12, img:'https://picsum.photos/seed/hp/600/400', badge:'-20% OFF', desc:'Over‑ear, 30h battery, Type‑C fast charge.'},
      {id:2, title:'Smartwatch Pro S', brand:'Fitora', category:'Electronics', price:3499, mrp:3999, rating:4.1, stock:8, img:'https://picsum.photos/seed/sw/600/400', badge:'NEW', desc:'AMOLED display, SpO₂, GPS, 5ATM.'},
      {id:3, title:'Cotton T‑Shirt', brand:'FabWear', category:'Fashion', price:499, mrp:899, rating:4.0, stock:30, img:'https://picsum.photos/seed/tee/600/400', badge:'BESTSELLER', desc:'100% combed cotton, regular fit.'},
      {id:4, title:'Sneakers Lite', brand:'Stride', category:'Fashion', price:1799, mrp:2199, rating:4.3, stock:16, img:'https://picsum.photos/seed/shoe/600/400', badge:'', desc:'Breathable mesh, EVA sole, unisex.'},
      {id:5, title:'Blender 500W', brand:'HomePro', category:'Home & Kitchen', price:1499, mrp:1999, rating:3.9, stock:20, img:'https://picsum.photos/seed/blender/600/400', badge:'', desc:'3 jars, 2‑yr warranty, low noise.'},
      {id:6, title:'Non‑stick Pan 28cm', brand:'CookEase', category:'Home & Kitchen', price:799, mrp:1299, rating:4.2, stock:25, img:'https://picsum.photos/seed/pan/600/400', badge:'DEAL', desc:'PFOA‑free coating, induction safe.'},
      {id:7, title:'Backpack 28L', brand:'TrailX', category:'Accessories', price:999, mrp:1499, rating:4.1, stock:18, img:'https://picsum.photos/seed/bag/600/400', badge:'', desc:'Laptop sleeve, water‑resistant fabric.'},
      {id:8, title:'LED Desk Lamp', brand:'Glowly', category:'Electronics', price:699, mrp:999, rating:4.0, stock:40, img:'https://picsum.photos/seed/lamp/600/400', badge:'', desc:'3 color modes, USB powered.'},
      {id:9, title:'Yoga Mat 6mm', brand:'ZenFit', category:'Sports', price:599, mrp:899, rating:4.2, stock:35, img:'https://picsum.photos/seed/yoga/600/400', badge:'', desc:'Non‑slip TPE, carry strap included.'},
      {id:10, title:'Gaming Keyboard RGB', brand:'Keylite', category:'Electronics', price:1299, mrp:1799, rating:4.5, stock:14, img:'https://picsum.photos/seed/keyboard/600/400', badge:'TRENDING', desc:'Mechanical feel, 18 lighting modes.'},
      {id:11, title:'Ceramic Mug Set', brand:'ClayCo', category:'Home & Kitchen', price:399, mrp:699, rating:3.8, stock:50, img:'https://picsum.photos/seed/mug/600/400', badge:'', desc:'Set of 2, 340ml each.'},
      {id:12, title:'Wireless Mouse', brand:'Sonic', category:'Electronics', price:499, mrp:799, rating:4.1, stock:45, img:'https://picsum.photos/seed/mouse/600/400', badge:'', desc:'Ergonomic, 2.4GHz, 12‑month battery.'}
    ];

    // ====== State & persistence ======
    const state = {
      query: '',
      filters: { categories: new Set(), brands: new Set(), maxPrice: 2000, rating: 0, deals:false, wishlistOnly:false },
      sort: 'pop',
      cart: JSON.parse(localStorage.getItem('cart')||'[]'),
      wishlist: new Set(JSON.parse(localStorage.getItem('wishlist')||'[]')),
    };

    function save(){
      localStorage.setItem('cart', JSON.stringify(state.cart));
      localStorage.setItem('wishlist', JSON.stringify([...state.wishlist]));
    }

    // ====== Router ======
    function go(hash){ location.hash = hash; route(); }
    function route(e){ if(e) e.preventDefault(); const hash = location.hash || '#home';
      document.querySelectorAll('section.page').forEach(s=>s.classList.remove('active'));
      const [path, id] = hash.split('/');
      const page = document.querySelector(path);
      if(!page) return;
      page.classList.add('active');
      if(path==='#shop') renderShop();
      if(path==='#product') renderProduct(+id);
      if(path==='#cart') renderCart();
      if(path==='#checkout'){ renderOrderSummary(); }
      if(path==='#home') renderTrending();
      if(path==='#wishlist') renderWishlist();
    }
    window.addEventListener('hashchange', route);

    // ====== UI Helpers ======
    function toast(msg){ const t=document.getElementById('toast'); t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'), 1800) }
    function curr(n){ return '₹' + n.toLocaleString('en-IN') }

    // ====== Search ======
    const searchInput = document.getElementById('search');
    searchInput.addEventListener('input', e=>{ state.query = e.target.value.trim().toLowerCase(); renderProducts();});
    window.addEventListener('keydown', e=>{ if(e.key==='/' && document.activeElement!==searchInput){ e.preventDefault(); searchInput.focus(); } });

    // ====== Filters ======
    function updatePriceRange(v){ state.filters.maxPrice = +v; document.getElementById('priceValue').textContent = '₹'+v; renderProducts(); }

    function renderShop(){
      // Build filter lists once
      const cats = [...new Set(PRODUCTS.map(p=>p.category))];
      const brands = [...new Set(PRODUCTS.map(p=>p.brand))];
      document.getElementById('catFilters').innerHTML = cats.map(c=>`<label><input type="checkbox" data-type="cat" value="${c}"> ${c}</label>`).join('');
      document.getElementById('brandFilters').innerHTML = brands.map(b=>`<label><input type="checkbox" data-type="brand" value="${b}"> ${b}</label>`).join('');
      document.getElementById('sort').value = state.sort;
      document.getElementById('priceRange').value = state.filters.maxPrice;
      document.getElementById('ratingFilter').value = state.filters.rating;
      document.getElementById('onlyDeals').checked = state.filters.deals;
      document.getElementById('onlyWishlist').checked = state.filters.wishlistOnly;

      // attach change listeners once
      document.querySelectorAll('#catFilters input, #brandFilters input').forEach(inp=>{
        inp.onchange = (e)=>{
          const set = e.target.dataset.type==='cat' ? state.filters.categories : state.filters.brands;
          e.target.checked ? set.add(e.target.value) : set.delete(e.target.value);
          renderProducts();
        };
      });

      renderProducts();
    }

    function renderProducts(){
      const grid = document.getElementById('productGrid');
      const sort = state.sort = document.getElementById('sort').value;
      state.filters.rating = +document.getElementById('ratingFilter').value;
      state.filters.deals = document.getElementById('onlyDeals').checked;
      state.filters.wishlistOnly = document.getElementById('onlyWishlist').checked;

      let list = PRODUCTS.filter(p=>
        (!state.query || p.title.toLowerCase().includes(state.query) || p.desc.toLowerCase().includes(state.query)) &&
        (state.filters.categories.size===0 || state.filters.categories.has(p.category)) &&
        (state.filters.brands.size===0 || state.filters.brands.has(p.brand)) &&
        (p.price <= state.filters.maxPrice) &&
        (p.rating >= state.filters.rating) &&
        (!state.filters.deals || p.price < p.mrp) &&
        (!state.filters.wishlistOnly || state.wishlist.has(p.id))
      );

      if(sort==='price-asc') list.sort((a,b)=>a.price-b.price);
      else if(sort==='price-desc') list.sort((a,b)=>b.price-a.price);
      else if(sort==='name') list.sort((a,b)=>a.title.localeCompare(b.title));
      else if(sort==='rating') list.sort((a,b)=>b.rating-a.rating);

      document.getElementById('searchCount').classList.toggle('hide', !state.query);
      if(state.query) document.getElementById('searchCount').textContent = list.length + ' results';

      grid.innerHTML = list.map(cardHTML).join('');
      updateCounts();
      // Bind wish & add buttons
      list.forEach(p=>{
        document.getElementById('wish-'+p.id).onclick = ()=>toggleWish(p.id);
        document.getElementById('add-'+p.id).onclick = ()=>addToCart(p.id);
        document.getElementById('open-'+p.id).onclick = ()=>go('#product/'+p.id);
      });
    }

    function cardHTML(p){
      const wished = state.wishlist.has(p.id);
      return `<div class="card hoverable">
        ${p.badge?`<span class="badge">${p.badge}</span>`:''}
        <button class="wish ${wished?'active':''}" id="wish-${p.id}" title="Toggle wishlist" aria-label="Toggle wishlist">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="${wished?'#6ee7b7':'currentColor'}"><path d="M20.8 8.6a5.5 5.5 0 0 0-9.8-3.6 5.5 5.5 0 0 0-9.8 3.6c0 7.2 9.8 11.8 9.8 11.8s9.8-4.6 9.8-11.8z"/></svg>
        </button>
        <div class="thumb" id="open-${p.id}" style="cursor:pointer">
          <img alt="${p.title}" src="${p.img}">
        </div>
        <div class="body">
          <div style="display:flex; justify-content:space-between; gap:10px">
            <div>
              <div class="pill" style="display:inline-block; margin-bottom:6px">${p.category}</div>
              <h4 style="margin:0 0 6px">${p.title}</h4>
              <div style="color:var(--sub); font-size:14px;">${p.brand} • ⭐ ${p.rating.toFixed(1)}</div>
            </div>
            <div style="text-align:right">
              <div class="price">${curr(p.price)}</div>
              <div class="strike">${curr(p.mrp)}</div>
            </div>
          </div>
          <div style="display:flex; gap:8px; margin-top:10px">
            <button id="add-${p.id}" class="btn primary" style="flex:1">Add to Cart</button>
            <button id="open-${p.id}" class="btn" style="flex:1">Details</button>
          </div>
        </div>
      </div>`
    }

    // ====== Product detail ======
    function renderProduct(id){
      const p = PRODUCTS.find(x=>x.id===id);
      if(!p){ document.getElementById('productDetail').innerHTML = '<p>Product not found.</p>'; return; }
      const el = document.getElementById('productDetail');
      el.innerHTML = `
        <div class="two">
          <div class="card" style="overflow:hidden">
            <div class="thumb"><img alt="${p.title}" src="${p.img}"></div>
          </div>
          <div>
            <h2 style="margin-top:0">${p.title}</h2>
            <p style="color:var(--sub)">${p.desc}</p>
            <div style="display:flex; gap:16px; align-items:center; margin:10px 0">
              <span class="pill">${p.category}</span>
              <span class="pill">${p.brand}</span>
              <span class="pill">⭐ ${p.rating}</span>
            </div>
            <div style="display:flex; align-items:baseline; gap:10px; margin:10px 0">
              <div class="price">${curr(p.price)}</div>
              <div class="strike">${curr(p.mrp)}</div>
            </div>
            <div style="display:flex; gap:10px; flex-wrap:wrap">
              <button class="btn primary" onclick="addToCart(${p.id})">Add to Cart</button>
              <button class="btn" onclick="toggleWish(${p.id})">${state.wishlist.has(p.id)?'Remove from':'Add to'} Wishlist</button>
              <button class="btn" onclick="go('#shop')">Back to Shop</button>
            </div>
          </div>
        </div>`;
    }

    // ====== Wishlist page ======
    function renderWishlist(){
      const list = PRODUCTS.filter(p=>state.wishlist.has(p.id));
      const grid = document.getElementById('wishlistGrid');
      grid.innerHTML = list.length? list.map(cardHTML).join('') : '<p>Your wishlist is empty.</p>';
      list.forEach(p=>{
        document.getElementById('wish-'+p.id).onclick = ()=>toggleWish(p.id);
        document.getElementById('add-'+p.id).onclick = ()=>addToCart(p.id);
        document.getElementById('open-'+p.id).onclick = ()=>go('#product/'+p.id);
      });
    }

    // ====== Cart ======
    function addToCart(id, qty=1){
      const item = state.cart.find(x=>x.id===id);
      if(item) item.qty += qty; else state.cart.push({id, qty});
      save(); updateCounts(); toast('Added to cart');
    }
    function removeFromCart(id){ state.cart = state.cart.filter(x=>x.id!==id); save(); renderCart(); updateCounts(); }
    function changeQty(id, delta){ const it=state.cart.find(x=>x.id===id); if(!it) return; it.qty = Math.max(1, it.qty + delta); save(); renderCart(); }

    function cartLines(){
      return state.cart.map(it=>{ const p=PRODUCTS.find(x=>x.id===it.id); return {...p, qty:it.qty, line:p.price*it.qty}; });
    }

    function totals(){
      const lines = cartLines();
      const subtotal = lines.reduce((s,l)=>s+l.line,0);
      const discount = lines.reduce((s,l)=> s + Math.max(0,(l.mrp-l.price))*l.qty, 0);
      const shipping = subtotal>1499 || subtotal===0 ? 0 : 79;
      const tax = Math.round(subtotal * 0.18);
      const grand = subtotal + shipping + tax;
      return {lines, subtotal, discount, shipping, tax, grand};
    }

    function renderCart(){
      const view = document.getElementById('cartView');
      const {lines, subtotal, discount, shipping, tax, grand} = totals();
      if(lines.length===0){ view.innerHTML = '<p>Your cart is empty.</p>'; return; }
      view.innerHTML = `
        <div class="two">
          <div class="card" style="padding:12px; overflow:auto">
            <table>
              <thead><tr><th>Item</th><th>Price</th><th>Qty</th><th>Total</th><th></th></tr></thead>
              <tbody>
                ${lines.map(l=>`<tr>
                  <td><div style="display:flex; align-items:center; gap:10px"><img src="${l.img}" alt="${l.title}" style="width:64px; height:48px; object-fit:cover; border-radius:8px"><div><div>${l.title}</div><div style="color:var(--sub); font-size:12px">${l.brand} • ${l.category}</div></div></div></td>
                  <td>${curr(l.price)}</td>
                  <td>
                    <button class="btn" onclick="changeQty(${l.id},-1)" title="Decrease">−</button>
                    <span class="pill">${l.qty}</span>
                    <button class="btn" onclick="changeQty(${l.id},1)" title="Increase">+</button>
                  </td>
                  <td>${curr(l.line)}</td>
                  <td><button class="btn" onclick="removeFromCart(${l.id})" title="Remove"><svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 6h18"/><path d="M8 6v14a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V6"/><path d="M10 11v6M14 11v6"/></svg></button></td>
                </tr>`).join('')}
              </tbody>
            </table>
          </div>
          <div class="card" style="padding:16px">
            <h3 style="margin-top:0">Summary</h3>
            <div class="total"><span>Subtotal</span><b>${curr(subtotal)}</b></div>
            <div class="total"><span>Product Discount</span><b>− ${curr(discount)}</b></div>
            <div class="total"><span>Shipping</span><b>${shipping?curr(shipping):'Free'}</b></div>
            <div class="total"><span>GST (18%)</span><b>${curr(tax)}</b></div>
            <div class="total" style="font-size:18px"><span>Grand Total</span><b>${curr(grand)}</b></div>
            <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap">
              <button class="btn primary" onclick="go('#checkout')">Proceed to Checkout</button>
              <button class="btn" onclick="go('#shop')">Continue Shopping</button>
            </div>
          </div>
        </div>`;
    }

    function renderOrderSummary(){
      const {lines, subtotal, discount, shipping, tax, grand} = totals();
      const wrap = document.getElementById('orderSummary');
      if(lines.length===0){ wrap.innerHTML = '<p>Your cart is empty.</p>'; return; }
      wrap.innerHTML = `
        <div style="max-height:320px; overflow:auto; border:1px solid var(--muted); border-radius:12px">
          <table>
            <thead><tr><th>Item</th><th>Qty</th><th>Total</th></tr></thead>
            <tbody>
              ${lines.map(l=>`<tr><td>${l.title}</td><td>${l.qty}</td><td>${curr(l.line)}</td></tr>`).join('')}
            </tbody>
          </table>
        </div>
        <div class="total"><span>Subtotal</span><b>${curr(subtotal)}</b></div>
        <div class="total"><span>Discount</span><b>− ${curr(discount)}</b></div>
        <div class="total"><span>Shipping</span><b>${shipping?curr(shipping):'Free'}</b></div>
        <div class="total"><span>GST (18%)</span><b>${curr(tax)}</b></div>
        <div class="total" style="font-size:18px"><span>Grand Total</span><b>${curr(grand)}</b></div>`;
    }

    // ====== Wishlist ======
    function toggleWish(id){ if(state.wishlist.has(id)){ state.wishlist.delete(id); toast('Removed from wishlist'); } else { state.wishlist.add(id); toast('Added to wishlist'); } save(); updateCounts(); if(location.hash==='#wishlist') renderWishlist(); if(location.hash==='#shop') renderProducts(); }

    // ====== Checkout / Payment (mock) ======
    function submitOrder(e){ e.preventDefault(); const fd = new FormData(e.target); const order = Object.fromEntries(fd.entries());
      const {grand} = totals(); if(grand===0){ toast('Your cart is empty.'); return; }
      if(order.payment==='cod'){ completeOrder('Cash on Delivery — order placed!'); return; }
      toast('Launching test payment…');
      // Note: Replace simulatePayment with real gateway integration below.
      // Example Razorpay:
      // const rzp = new Razorpay({ key: 'RAZORPAY_KEY', amount: grand*100, currency:'INR', name:'Arvind Super Market', description:'Order Payment', handler: function(resp){ completeOrder('Payment successful via Razorpay'); } });
      // rzp.open();
    }

    function simulatePayment(which){ const {grand}=totals(); if(grand===0){ toast('Add items to cart first'); return; }
      setTimeout(()=> completeOrder(`Simulated ${which==='stripe'?'Stripe':'Razorpay'} payment success!`), 600);
    }

    function completeOrder(msg){ toast(msg); state.cart = []; save(); updateCounts(); go('#home'); }

    // ====== Misc ======
    function updateCounts(){ document.getElementById('cartCount').textContent = state.cart.reduce((s,it)=>s+it.qty,0); document.getElementById('wishCount').textContent = state.wishlist.size; }

    function renderTrending(){
      const top = [...PRODUCTS].sort((a,b)=>b.rating-a.rating).slice(0,4);
      const wrap = document.getElementById('trending');
      wrap.innerHTML = top.map(cardHTML).join('');
      top.forEach(p=>{
        document.getElementById('wish-'+p.id).onclick = ()=>toggleWish(p.id);
        document.getElementById('add-'+p.id).onclick = ()=>addToCart(p.id);
        document.getElementById('open-'+p.id).onclick = ()=>go('#product/'+p.id);
      });
    }

    function contactSubmit(e){ e.preventDefault(); toast('Thanks! We will get back to you.'); e.target.reset(); }
    function loginSubmit(e){ e.preventDefault(); toast('Logged in (demo).'); go('#home'); }
    function registerSubmit(e){ e.preventDefault(); toast('Account created (demo).'); go('#home'); }

    // Init
    document.getElementById('year').textContent = new Date().getFullYear();
    route(); updateCounts(); renderTrending();
  </script>

  <!-- Payment provider SDK placeholders (uncomment when you add real keys) -->
  <!-- <script src="https://checkout.razorpay.com/v1/checkout.js"></script> -->
  <!-- <script src="https://js.stripe.com/v3"></script> -->
</body>
</html>
